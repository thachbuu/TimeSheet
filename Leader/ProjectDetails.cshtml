@{
    Page.Title = "Project Details";
    var db = Database.Open("StarterSite");
    var projectId = Request["ProjectId"];
    var feedbackMsg="";
    
    if(IsPost){
        var projectDescription = Request["projectDescription"] ;
        var datepickerStartedDate = Request["datepickerStartedDate"];
        var datepickerEndDate = Request["datepickerEndDate"];

        if(projectDescription!=null && projectDescription !="" && datepickerStartedDate !="" && datepickerEndDate!=""){
            var updateProjectQuery = "UPDATE Projects SET Description=@0, StartedDate=@1, EndDate=@2 WHERE ProjectId=@3";
            db.Execute(updateProjectQuery,projectDescription,datepickerStartedDate,datepickerEndDate,projectId);
            Response.Redirect("~/Leader/ManageProjects");
        }
    }

    var query = "SELECT * FROM Projects WHERE ProjectId=@0"; 
    var data = db.QuerySingle(query,projectId);
}

 
<script>
    $(function () {
        $("#datepickerStartedDate").datepicker({ showAnim: "fold" });
        $("#datepickerEndDate").datepicker({ showAnim: "fold" });
        $("#submit").click(function () {
            $("input[name=projectDescription]").attr('value',$("#projectDescription").val());
        });               
    });               
</script>   
  
<form method="post" action="">
    <div id="projectName">Project: @data.ProjectName</div>

    <div class="projectHeader">Project Description</div>
    <div id="description"><textarea id="projectDescription">@data.Description</textarea></div>            
    <div>
        <div class="projectHeader">StartedDate</div>
        <input id="datepickerStartedDate" value="@data.StartedDate.ToString("d")" name="datepickerStartedDate">            
    </div>

    <div>
        <div class="projectHeader">EndDate</div>
        <input id="datepickerEndDate" value="@data.EndDate.ToString("d")" name="datepickerEndDate">
    </div>

    <div id="member-in-project">            
        @RenderPage("~/Leader/GetMembers.cshtml")
    </div>

    <input type="hidden" name="projectDescription" value="">
    <input type="hidden" name="projectId" value="@projectId">
    <input id="submit" type="submit" value="Save and Exit">
    <div class="feedback">@feedbackMsg</div>       
</form>
